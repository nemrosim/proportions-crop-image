(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{137:function(e,t,a){},138:function(e,t,a){},139:function(e,t,a){},144:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),c=a.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o,l=a(10),s=a(176),m=a(173),u=a(177),d=a(178),g=a(147),p=a(179),f=a(180),b=a(55),h=a.n(b),v=a(56),I=a.n(v),E={wallpaperImage:void 0,setWallpaperImage:function(){},isWallpaperImagesLoading:!1,setIsWallpaperImagesLoading:function(){},roomImages:void 0,setRoomImages:function(){},isRoomImagesLoading:!1,setIsRoomImagesLoading:function(){}},x=r.a.createContext(E);!function(e){e[e.ORIGINAL=0]="ORIGINAL",e[e.SEPIA=1]="SEPIA",e[e.BLACK_WHITE=2]="BLACK_WHITE"}(o||(o={}));var y={imageWidth:600,setImageWidth:function(){},imageHeight:400,setImageHeight:function(){},imageType:o.ORIGINAL,setImageType:function(){},cropperInstance:400,setCropperInstance:function(){},getCroppedImagedBase64String:function(){}},O=r.a.createContext(y),j=function(){var e=Object(n.useContext)(x),t=e.wallpaperImage,a=e.isWallpaperImagesLoading,i=Object(n.useContext)(O),c=i.imageHeight,o=i.imageWidth,l=i.cropperInstance,s=i.setCropperInstance,u=r.a.useRef();return a?r.a.createElement("div",{className:"flex justify-center items-center",style:{flexDirection:"column"}},r.a.createElement(I.a,{type:"Watch",color:"#00BFFF",width:700}),r.a.createElement(m.a,null,"Loading image")):r.a.createElement("div",{style:{padding:"10px"}},r.a.createElement("div",null,r.a.createElement("img",{ref:u,alt:"CroppedImage",style:{maxWidth:"100%"},src:null===t||void 0===t?void 0:t.original,onLoad:function(){l||function(){if(c&&o&&u){var e={aspectRatio:o/c,preview:".img-preview",viewMode:3},t=new h.a(u.current,e);u.current.addEventListener("cropend",(function(){})),s(t)}}()}})))},C=function(e){var t=e.children,a=Object(n.useState)(o.ORIGINAL),i=Object(l.a)(a,2),c=i[0],s=i[1],m=Object(n.useState)(600),u=Object(l.a)(m,2),d=u[0],g=u[1],p=Object(n.useState)(400),f=Object(l.a)(p,2),b=f[0],h=f[1],v=Object(n.useState)(),I=Object(l.a)(v,2),E=I[0],x=I[1];return r.a.createElement(O.Provider,{value:{imageType:c,setImageType:s,imageWidth:d,setImageWidth:g,imageHeight:b,setImageHeight:h,cropperInstance:E,setCropperInstance:x,getCroppedImagedBase64String:function(){var e=E.getCroppedCanvas({imageSmoothingEnabled:!0,imageSmoothingQuality:"low"});return e?e.toDataURL("image/png"):void 0}}},t)},w=a(37),L=a.n(w).a.create({baseURL:"http://localhost:3000/api/",timeout:1e4,headers:{"Content-Type":"application/json"}}),S="/image",W="/image/rooms/children",R=function(e){var t=e.children,a=Object(n.useState)(),i=Object(l.a)(a,2),c=i[0],o=i[1],s=Object(n.useState)(!0),m=Object(l.a)(s,2),u=m[0],d=m[1],g=Object(n.useState)(),p=Object(l.a)(g,2),f=p[0],b=p[1],h=Object(n.useState)(!0),v=Object(l.a)(h,2),I=v[0],E=v[1];return Object(n.useEffect)((function(){d(!0),L.get(S).then((function(e){var t=e.data;o(t),d(!1)})),E(!0),L.get(W).then((function(e){var t=e.data;b(t),E(!1)}))}),[]),r.a.createElement(x.Provider,{value:{wallpaperImage:c,setWallpaperImage:o,isWallpaperImagesLoading:u,setIsWallpaperImagesLoading:d,roomImages:f,setRoomImages:b,isRoomImagesLoading:I,setIsRoomImagesLoading:E}},t)},A=a(60),T=a.n(A),k={images:void 0,setImages:function(){},isModalVisible:!1,setIsModalVisible:function(){}},N=r.a.createContext(k),H=function(e){var t=e.children,a=Object(n.useState)(!1),i=Object(l.a)(a,2),c=i[0],o=i[1],s=Object(n.useState)([]),m=Object(l.a)(s,2),u=m[0],d=m[1];return r.a.createElement(N.Provider,{value:{images:u,setImages:d,isModalVisible:c,setIsModalVisible:o}},t)},B=function(){var e=Object(n.useContext)(N),t=e.images,a=e.setImages,i=e.isModalVisible,c=e.setIsModalVisible,o=Object(n.useContext)(x).roomImages;return Object(n.useEffect)((function(){(null===t||void 0===t?void 0:t.length)===(null===o||void 0===o?void 0:o.length)&&c(!0)}),[t,i,JSON.stringify(o)]),r.a.createElement(T.a,{visible:i,onClose:function(){c(!1),a([])},images:t})},G=a(183),M=a(181),P=a(175),V=function(){var e=Object(P.a)("(max-width:720px)"),t=Object(n.useContext)(O),a=t.cropperInstance,i=t.imageWidth,c=t.setImageWidth,o=t.imageHeight,l=t.setImageHeight,m=function(e){return Number.parseInt(e,10)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{item:!0,xs:6,justify:"center",alignItems:"center"},r.a.createElement(G.a,{mx:e?"10px":"0"},r.a.createElement(M.a,{label:"\u0428\u0438\u0440\u0438\u043d\u0430, \u0421\u041c",type:"number",value:i,onChange:function(e){var t=m(e.target.value);a.setAspectRatio(t/o),c(t)},margin:"normal",variant:"outlined",fullWidth:e}))),r.a.createElement(s.a,{item:!0,xs:6},r.a.createElement(G.a,{mx:e?"10px":"0"},r.a.createElement(M.a,{label:"\u0412\u044b\u0441\u043e\u0442\u0430, \u0421\u041c",type:"number",value:o,onChange:function(e){var t=m(e.target.value);a.setAspectRatio(i/t),l(t)},margin:"normal",variant:"outlined",fullWidth:e}))))},D=a(38),F=a.n(D),K=a(71),U=a(61),_=a(62),z=a.n(_),J=a(63),X={hiddenStyle:{display:"none"},widthStyle:{width:"100%",border:"4px double black",margin:".5rem"}},Q=function(e){var t=e.roomImage,a=Object(n.useContext)(N).setImages,i=Object(n.useContext)(O).getCroppedImagedBase64String,c=Object(n.useState)(),o=Object(l.a)(c,2),s=o[0],m=o[1],u=Object(n.useState)(),d=Object(l.a)(u,2),g=d[0],p=d[1],f=Object(n.useState)(!1),b=Object(l.a)(f,2),h=b[0],v=b[1],I=r.a.createRef(),E=r.a.createRef();Object(n.useEffect)((function(){try{var e=z.a.canvas();p(e)}catch(t){alert(t)}}),[]);var x=function(){var e=Object(U.a)(F.a.mark((function e(){var n,r,i,c,o,l,s,u,d,p,f,b,E,x,y,O,j;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=15;break}return n=I.current,r=g.texture(n),i=t.width,c=t.height,o=t.cropCoordinates,l=[0,0,i,0,0,c,i,c],s=o.ax,u=o.ay,d=o.bx,p=o.by,f=o.cx,b=o.cy,E=o.dx,x=o.dy,y=[s,u,d,p,f,b,E,x],g.draw(r).perspective(l,y).update(),v(!0),O=g.toDataURL("image/png"),e.next=12,Object(J.a)([O,t.url]);case 12:j=e.sent,n.src=j,a((function(e){var t={src:j,alt:"\u041e\u0434\u0438\u043d \u0438\u0437 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"};return e.length?[].concat(Object(K.a)(e),[t]):[t]}));case 15:m(!0);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{display:"none"}},r.a.createElement("canvas",{ref:E}),r.a.createElement("img",{ref:I,style:s?X.widthStyle:X.hiddenStyle,onLoad:x}),r.a.createElement("img",{className:"hidden",style:{border:"4px double black",margin:".5rem"},src:i(),onLoad:function(){var e=new Image,a=E.current,n=a.getContext("2d"),r=I.current,c=t.width,o=t.height;e.onload=function(){a.width=c,a.height=o;var t=document.createElement("canvas"),i=t.getContext("2d");t.width=c,t.height=o,i&&(i.drawImage(e,0,0,t.width,t.height),n.drawImage(t,0,0,t.width,t.height,0,0,a.width,a.height),r.src=a.toDataURL("image/png"))},e.src=i()||""}}))},$=function(){var e=Object(n.useContext)(O),t=e.cropperInstance,a=e.imageType,i=e.setImageType,c=Object(n.useContext)(x).wallpaperImage;return r.a.createElement(s.a,{item:!0,xs:12},r.a.createElement(d.a,{fullWidth:!0,color:"primary",size:"small"},r.a.createElement(g.a,{color:"default",onClick:function(){a===o.ORIGINAL||a===o.SEPIA?(t.replace(null===c||void 0===c?void 0:c.blackAndWhite),i(o.BLACK_WHITE)):(t.replace(null===c||void 0===c?void 0:c.original),i(o.ORIGINAL))}},"\u0427/\u0411"),r.a.createElement(g.a,{color:"default",onClick:function(){a===o.ORIGINAL||a===o.BLACK_WHITE?(t.replace(null===c||void 0===c?void 0:c.sepia),i(o.SEPIA)):(t.replace(null===c||void 0===c?void 0:c.original),i(o.ORIGINAL))}},"\u0421\u0435\u043f\u0438\u044f"),r.a.createElement(g.a,{color:"default",onClick:function(){1===t.getData().scaleX?t.scaleX(-1):t.scaleX(1)}},"\u041e\u0442\u0437\u0435\u0440\u043a\u0430\u043b\u0438\u0442\u044c")))},q=a(64),Y=a.n(q),Z=function(){return r.a.createElement(s.a,{item:!0,xs:12,justify:"center",alignItems:"center"},r.a.createElement("div",{style:{display:"flex",justifyContent:"center",paddingTop:"10px"}},r.a.createElement("div",{className:"docs-preview clearfix"},r.a.createElement("div",{className:"img-preview preview-lg"}))))},ee=function(){return r.a.createElement("div",{className:"flex justify-center"},r.a.createElement(m.a,null,r.a.createElement("b",null,"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435!"),"\u0414\u0430\u043d\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043f\u043e \u0412\u0430\u0448\u0435\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u043e \u043d\u0430\u0448\u0438\u043c \u0434\u0438\u0437\u0430\u0439\u043d\u0435\u0440\u043e\u043c (\u0446\u0432\u0435\u0442, \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438 \u0438 \u0442.\u0434.)"))},te=function(e){var t=e.onCLickHandler,a=Object(P.a)("(max-width:720px)");return r.a.createElement(u.a,{style:{marginTop:".5rem"}},r.a.createElement(m.a,{variant:"h5",color:"textPrimary",component:"p"},"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043e\u0431\u0440\u0435\u0437\u0430\u043d\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0432 \u0438\u043d\u0442\u0435\u0440\u044c\u0435\u0440\u0430\u0445"),r.a.createElement(s.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(d.a,{id:"button group",color:"primary","aria-label":"small outlined primary button group",style:{margin:"1rem"},size:"small",orientation:a?"vertical":"horizontal"},r.a.createElement(g.a,{style:{textTransform:"none"},onClick:t},"\u0414\u0435\u0442\u0441\u043a\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u041e\u0442\u043a\u0440\u044b\u0442\u0430\u044f \u0441\u0442\u0435\u043d\u0430"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0421\u0442\u0435\u043d\u0430 \u0441 \u043f\u0440\u043e\u0435\u043c\u043e\u043c"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0423\u0433\u043b\u043e\u0432\u0430\u044f \u0441\u0442\u0435\u043d\u0430"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0417\u0430 \u0442\u0435\u043b\u0435\u0432\u0438\u0437\u043e\u0440\u043e\u043c"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0417\u0430 \u0434\u0438\u0432\u0430\u043d\u043e\u043c"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0417\u0430 \u043a\u0440\u043e\u0432\u0430\u0442\u044c\u044e"))))},ae=function(){var e=Object(n.useContext)(x),t=e.roomImages,a=e.isRoomImagesLoading,i=e.isWallpaperImagesLoading,c=Object(n.useContext)(N),o=c.images,m=c.setIsModalVisible,d=Object(n.useContext)(O).cropperInstance,g=Object(n.useState)(!1),b=Object(l.a)(g,2),h=b[0],v=b[1],I=Object(n.useState)(!1),E=Object(l.a)(I,2),y=E[0],C=E[1];return Object(n.useEffect)((function(){(null===o||void 0===o?void 0:o.length)===(null===t||void 0===t?void 0:t.length)&&(C(!1),m(!0),v(!1))}),[o,t,C,m,v]),r.a.createElement(Y.a,{active:i||a||y,spinner:!0,text:a?"Loading images":"Processing images"},d&&h&&(null===t||void 0===t?void 0:t.map((function(e){return r.a.createElement(Q,{roomImage:e})}))),r.a.createElement(p.a,{style:{padding:"10px"}},r.a.createElement(u.a,{style:{padding:"10px"}},r.a.createElement(s.a,{container:!0},r.a.createElement(s.a,{item:!0,xs:12,sm:12,md:8,style:{padding:"10xp"}},r.a.createElement(j,null)),r.a.createElement(s.a,{item:!0,xs:12,sm:12,md:4},r.a.createElement(s.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(V,null),r.a.createElement($,null),r.a.createElement(Z,null))),r.a.createElement(s.a,{item:!0,xs:12},r.a.createElement(f.a,null))),r.a.createElement(p.a,{style:{paddingBottom:".5rem"}},r.a.createElement(ee,null))),r.a.createElement(te,{onCLickHandler:function(){v(!0),C(!0)}})))},ne=(a(137),a(138),a(139),a(140),a(65)),re=new(a.n(ne).a)(L,{delayResponse:1e3}),ie=a(66),ce=a.n(ie),oe=a(67),le=a.n(oe),se={rooms:{children:[{url:ce.a,width:960,height:700,cropCoordinates:{ax:0,ay:75,bx:540,by:125,cx:0,cy:439,dx:540,dy:429}},{url:le.a,width:879,height:678,cropCoordinates:{ax:0,ay:7,bx:551,by:147,cx:0,cy:594,dx:551,dy:462}}]}};re.onGet(W).reply((function(){return[200,se.rooms.children]}));var me=a(68),ue=a.n(me),de=a(69),ge=a.n(de),pe=a(70),fe=a.n(pe),be={building:{original:ue.a,blackAndWhite:ge.a,sepia:fe.a}};re.onGet(S).reply((function(){return[200,be.building]})),re.onAny().passThrough();var he=function(e){var t=e.children;return r.a.createElement(R,null,r.a.createElement(C,null,r.a.createElement(H,null,t,r.a.createElement(B,null))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(he,null,r.a.createElement(ae,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},66:function(e,t,a){e.exports=a.p+"static/media/detskaya-komnata-1.09cece57.png"},67:function(e,t,a){e.exports=a.p+"static/media/detskaya-komnata-2.ddfbcda9.png"},68:function(e,t,a){e.exports=a.p+"static/media/building-01-orig.973ed778.png"},69:function(e,t,a){e.exports=a.p+"static/media/building-01-bw.9186d37a.png"},70:function(e,t,a){e.exports=a.p+"static/media/building-01-sepia.95d280bc.png"},82:function(e,t,a){e.exports=a(144)}},[[82,1,2]]]);
//# sourceMappingURL=main.71f35370.chunk.js.map