(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{131:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){},138:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),o=a.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,l=a(10),s=a(167),m=a(172),u=a(171),d=a(173),g=a(139),p=a(174),f=a(175),b=a(52),v=a.n(b),I=a(53),h=a.n(I),E={wallpaperImage:void 0,setWallpaperImage:function(){},isWallpaperImagesLoading:!1,setIsWallpaperImagesLoading:function(){},roomImages:void 0,setRoomImages:function(){},isRoomImagesLoading:!1,setIsRoomImagesLoading:function(){}},y=r.a.createContext(E);!function(e){e[e.ORIGINAL=0]="ORIGINAL",e[e.SEPIA=1]="SEPIA",e[e.BLACK_WHITE=2]="BLACK_WHITE"}(c||(c={}));var x={imageWidth:600,setImageWidth:function(){},imageHeight:400,setImageHeight:function(){},imageType:c.ORIGINAL,setImageType:function(){},cropperInstance:400,setCropperInstance:function(){},getCroppedImagedBase64String:function(){}},O=r.a.createContext(x),j=function(){var e=Object(n.useContext)(y),t=e.wallpaperImage,a=e.isWallpaperImagesLoading,i=Object(n.useContext)(O),o=i.imageHeight,c=i.imageWidth,l=i.cropperInstance,m=i.setCropperInstance,u=r.a.useRef();return a?r.a.createElement("div",{className:"flex justify-center items-center",style:{flexDirection:"column"}},r.a.createElement(h.a,{type:"Watch",color:"#00BFFF",width:700}),r.a.createElement(s.a,null,"Loading image")):r.a.createElement("div",{style:{padding:"10px"}},r.a.createElement("div",null,r.a.createElement("img",{ref:u,alt:"CroppedImage",style:{maxWidth:"100%"},src:null===t||void 0===t?void 0:t.original,onLoad:function(){console.log("ON LOAD"),l||function(){if(o&&c&&u){console.log("HELLOO");var e={aspectRatio:c/o,preview:".img-preview",viewMode:3},t=new v.a(u.current,e);u.current.addEventListener("cropend",(function(){})),m(t)}}()}})))},C=function(e){var t=e.children,a=Object(n.useState)(c.ORIGINAL),i=Object(l.a)(a,2),o=i[0],s=i[1],m=Object(n.useState)(600),u=Object(l.a)(m,2),d=u[0],g=u[1],p=Object(n.useState)(400),f=Object(l.a)(p,2),b=f[0],v=f[1],I=Object(n.useState)(),h=Object(l.a)(I,2),E=h[0],y=h[1];return r.a.createElement(O.Provider,{value:{imageType:o,setImageType:s,imageWidth:d,setImageWidth:g,imageHeight:b,setImageHeight:v,cropperInstance:E,setCropperInstance:y,getCroppedImagedBase64String:function(){var e=E.getCroppedCanvas({imageSmoothingEnabled:!0,imageSmoothingQuality:"low"});return e?e.toDataURL("image/png"):void 0}}},t)},w=a(34),L=a.n(w).a.create({baseURL:"http://localhost:3000/api/",timeout:1e4,headers:{"Content-Type":"application/json"}}),S="/image",R="/image/rooms/children",W=function(e){var t=e.children,a=Object(n.useState)(),i=Object(l.a)(a,2),o=i[0],c=i[1],s=Object(n.useState)(!0),m=Object(l.a)(s,2),u=m[0],d=m[1],g=Object(n.useState)(),p=Object(l.a)(g,2),f=p[0],b=p[1],v=Object(n.useState)(!0),I=Object(l.a)(v,2),h=I[0],E=I[1];return Object(n.useEffect)((function(){d(!0),L.get(S).then((function(e){var t=e.data;c(t),d(!1)})),E(!0),L.get(R).then((function(e){var t=e.data;b((function(){return console.log("setting",t),t})),E(!1)}))}),[]),r.a.createElement(y.Provider,{value:{wallpaperImage:o,setWallpaperImage:c,isWallpaperImagesLoading:u,setIsWallpaperImagesLoading:d,roomImages:f,setRoomImages:b,isRoomImagesLoading:h,setIsRoomImagesLoading:E}},t)},A=a(58),T=a.n(A),k={images:void 0,setImages:function(){},isModalVisible:!1,setIsModalVisible:function(){}},N=r.a.createContext(k),H=function(e){var t=e.children,a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1],s=Object(n.useState)([]),m=Object(l.a)(s,2),u=m[0],d=m[1];return r.a.createElement(N.Provider,{value:{images:u,setImages:d,isModalVisible:o,setIsModalVisible:c}},t)},B=function(){var e=Object(n.useContext)(N),t=e.images,a=e.setImages,i=e.isModalVisible,o=e.setIsModalVisible,c=Object(n.useContext)(y).roomImages;return Object(n.useEffect)((function(){(null===t||void 0===t?void 0:t.length)===(null===c||void 0===c?void 0:c.length)&&o(!0)}),[t,i,JSON.stringify(c)]),r.a.createElement(T.a,{visible:i,onClose:function(){o(!1),a([])},images:t})},G=a(176),M=function(){var e=Object(n.useContext)(O),t=e.cropperInstance,a=e.imageWidth,i=e.setImageWidth,o=e.imageHeight,c=e.setImageHeight,l=function(e){return Number.parseInt(e,10)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{item:!0,xs:6},r.a.createElement(G.a,{label:"\u0428\u0438\u0440\u0438\u043d\u0430, \u0421\u041c",type:"number",value:a,onChange:function(e){var a=l(e.target.value);t.setAspectRatio(a/o),i(a)},margin:"normal",variant:"outlined"})),r.a.createElement(u.a,{item:!0,xs:6},r.a.createElement(G.a,{label:"\u0412\u044b\u0441\u043e\u0442\u0430, \u0421\u041c",type:"number",value:o,onChange:function(e){var n=l(e.target.value);t.setAspectRatio(a/n),c(n)},margin:"normal",variant:"outlined"})))},P=a(35),V=a.n(P),D=a(69),F=a(59),K=a(60),U=a.n(K),_=a(61),J={hiddenStyle:{display:"none"},widthStyle:{width:"100%",border:"4px double black",margin:".5rem"}},X=function(e){var t=e.roomImage,a=Object(n.useContext)(N).setImages,i=Object(n.useContext)(O).getCroppedImagedBase64String,o=Object(n.useState)(),c=Object(l.a)(o,2),s=c[0],m=c[1],u=Object(n.useState)(),d=Object(l.a)(u,2),g=d[0],p=d[1],f=Object(n.useState)(!1),b=Object(l.a)(f,2),v=b[0],I=b[1],h=r.a.createRef(),E=r.a.createRef();Object(n.useEffect)((function(){try{var e=U.a.canvas();p(e)}catch(t){alert(t)}}),[]);var y=function(){var e=Object(F.a)(V.a.mark((function e(){var n,r,i,o,c,l,s,u,d,p,f,b,E,y,x,O,j;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=15;break}return n=h.current,r=g.texture(n),i=t.width,o=t.height,c=t.cropCoordinates,l=[0,0,i,0,0,o,i,o],s=c.ax,u=c.ay,d=c.bx,p=c.by,f=c.cx,b=c.cy,E=c.dx,y=c.dy,x=[s,u,d,p,f,b,E,y],g.draw(r).perspective(l,x).update(),I(!0),O=g.toDataURL("image/png"),e.next=12,Object(_.a)([O,t.url]);case 12:j=e.sent,n.src=j,a((function(e){var t={src:j,alt:"\u041e\u0434\u0438\u043d \u0438\u0437 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"};return e.length?[].concat(Object(D.a)(e),[t]):[t]}));case 15:m(!0);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{display:"none"}},r.a.createElement("canvas",{ref:E}),r.a.createElement("img",{ref:h,style:s?J.widthStyle:J.hiddenStyle,onLoad:y}),r.a.createElement("img",{className:"hidden",style:{border:"4px double black",margin:".5rem"},src:i(),onLoad:function(){var e=new Image,a=E.current,n=a.getContext("2d"),r=h.current,o=t.width,c=t.height;e.onload=function(){a.width=o,a.height=c;var t=document.createElement("canvas"),i=t.getContext("2d");t.width=o,t.height=c,i&&(i.drawImage(e,0,0,t.width,t.height),n.drawImage(t,0,0,t.width,t.height,0,0,a.width,a.height),r.src=a.toDataURL("image/png"))},e.src=i()||""}}))},z=function(){var e=Object(n.useContext)(O),t=e.cropperInstance,a=e.imageType,i=e.setImageType,o=Object(n.useContext)(y).wallpaperImage;return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{fullWidth:!0,color:"primary",size:"small"},r.a.createElement(g.a,{color:"default",onClick:function(){a===c.ORIGINAL||a===c.SEPIA?(t.replace(null===o||void 0===o?void 0:o.blackAndWhite),i(c.BLACK_WHITE)):(t.replace(null===o||void 0===o?void 0:o.original),i(c.ORIGINAL))}},"\u0427/\u0411"),r.a.createElement(g.a,{color:"default",onClick:function(){a===c.ORIGINAL||a===c.BLACK_WHITE?(t.replace(null===o||void 0===o?void 0:o.sepia),i(c.SEPIA)):(t.replace(null===o||void 0===o?void 0:o.original),i(c.ORIGINAL))}},"\u0421\u0435\u043f\u0438\u044f"),r.a.createElement(g.a,{color:"default",onClick:function(){1===t.getData().scaleX?t.scaleX(-1):t.scaleX(1)}},"\u041e\u0442\u0437\u0435\u0440\u043a\u0430\u043b\u0438\u0442\u044c")))},Q=a(62),$=a.n(Q),q=function(){return r.a.createElement("div",{style:{display:"flex",justifyContent:"center",paddingTop:"10px"}},r.a.createElement("div",{className:"docs-preview clearfix"},r.a.createElement("div",{className:"img-preview preview-lg"})))},Y=function(){return r.a.createElement("div",{className:"flex justify-center"},r.a.createElement(s.a,null,r.a.createElement("b",null,"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435!"),"\u0414\u0430\u043d\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043f\u043e \u0412\u0430\u0448\u0435\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u043e \u043d\u0430\u0448\u0438\u043c \u0434\u0438\u0437\u0430\u0439\u043d\u0435\u0440\u043e\u043c (\u0446\u0432\u0435\u0442, \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438 \u0438 \u0442.\u0434.)"))},Z=function(e){var t=e.onCLickHandler;return r.a.createElement(m.a,{style:{marginTop:".5rem"}},r.a.createElement(s.a,{variant:"h5",color:"textPrimary",component:"p"},"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043e\u0431\u0440\u0435\u0437\u0430\u043d\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0432 \u0438\u043d\u0442\u0435\u0440\u044c\u0435\u0440\u0430\u0445"),r.a.createElement(u.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(d.a,{id:"button group",color:"primary","aria-label":"small outlined primary button group",style:{margin:"1rem"},size:"small"},r.a.createElement(g.a,{style:{textTransform:"none"},onClick:t},"\u0414\u0435\u0442\u0441\u043a\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u041e\u0442\u043a\u0440\u044b\u0442\u0430\u044f \u0441\u0442\u0435\u043d\u0430"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0421\u0442\u0435\u043d\u0430 \u0441 \u043f\u0440\u043e\u0435\u043c\u043e\u043c"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0423\u0433\u043b\u043e\u0432\u0430\u044f \u0441\u0442\u0435\u043d\u0430"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0417\u0430 \u0442\u0435\u043b\u0435\u0432\u0438\u0437\u043e\u0440\u043e\u043c"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0417\u0430 \u0434\u0438\u0432\u0430\u043d\u043e\u043c"),r.a.createElement(g.a,{style:{textTransform:"none"}},"\u0417\u0430 \u043a\u0440\u043e\u0432\u0430\u0442\u044c\u044e"))))},ee=function(){var e=Object(n.useContext)(y),t=e.roomImages,a=e.isRoomImagesLoading,i=e.isWallpaperImagesLoading,o=Object(n.useContext)(N),c=o.images,s=o.setIsModalVisible,d=Object(n.useContext)(O).cropperInstance,g=Object(n.useState)(!1),b=Object(l.a)(g,2),v=b[0],I=b[1],h=Object(n.useState)(!1),E=Object(l.a)(h,2),x=E[0],C=E[1];return Object(n.useEffect)((function(){(null===c||void 0===c?void 0:c.length)===(null===t||void 0===t?void 0:t.length)&&(C(!1),s(!0),I(!1))}),[c,t,C,s,I]),r.a.createElement($.a,{active:i||a||x,spinner:!0,text:a?"Loading images":"Processing images"},d&&v&&(null===t||void 0===t?void 0:t.map((function(e){return r.a.createElement(X,{roomImage:e})}))),r.a.createElement(p.a,{style:{padding:"10px"}},r.a.createElement(m.a,{style:{padding:"10px"}},r.a.createElement(u.a,{container:!0},r.a.createElement(u.a,{item:!0,xs:12,sm:12,md:8,style:{padding:"10xp"}},r.a.createElement(j,null)),r.a.createElement(u.a,{item:!0,xs:12,sm:12,md:4},r.a.createElement(u.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(M,null),r.a.createElement(u.a,{item:!0,xs:12},r.a.createElement(z,null)),r.a.createElement(u.a,{item:!0,xs:12,justify:"center",alignItems:"center"},r.a.createElement(q,null)))),r.a.createElement(u.a,{item:!0,xs:12},r.a.createElement(f.a,null))),r.a.createElement(p.a,{style:{paddingBottom:".5rem"}},r.a.createElement(Y,null))),r.a.createElement(Z,{onCLickHandler:function(){I(!0),C(!0)}})))},te=(a(131),a(132),a(133),a(134),a(63)),ae=new(a.n(te).a)(L,{delayResponse:1e3}),ne=a(64),re=a.n(ne),ie=a(65),oe=a.n(ie),ce={rooms:{children:[{url:re.a,width:960,height:700,cropCoordinates:{ax:0,ay:75,bx:540,by:125,cx:0,cy:439,dx:540,dy:429}},{url:oe.a,width:879,height:678,cropCoordinates:{ax:0,ay:7,bx:551,by:147,cx:0,cy:594,dx:551,dy:462}}]}};ae.onGet(R).reply((function(){return[200,ce.rooms.children]}));var le=a(66),se=a.n(le),me=a(67),ue=a.n(me),de=a(68),ge=a.n(de),pe={building:{original:se.a,blackAndWhite:ue.a,sepia:ge.a}};ae.onGet(S).reply((function(){return[200,pe.building]})),ae.onAny().passThrough();var fe=function(e){var t=e.children;return r.a.createElement(W,null,r.a.createElement(C,null,r.a.createElement(H,null,t,r.a.createElement(B,null))))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(fe,null,r.a.createElement(ee,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},64:function(e,t,a){e.exports=a.p+"static/media/detskaya-komnata-1.09cece57.png"},65:function(e,t,a){e.exports=a.p+"static/media/detskaya-komnata-2.ddfbcda9.png"},66:function(e,t,a){e.exports=a.p+"static/media/building-01-orig.973ed778.png"},67:function(e,t,a){e.exports=a.p+"static/media/building-01-bw.9186d37a.png"},68:function(e,t,a){e.exports=a.p+"static/media/building-01-sepia.95d280bc.png"},76:function(e,t,a){e.exports=a(138)}},[[76,1,2]]]);
//# sourceMappingURL=main.58faf0fb.chunk.js.map